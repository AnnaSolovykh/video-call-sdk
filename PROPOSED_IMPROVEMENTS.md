# Архитектурные улучшения Video Call SDK

## Подписка через WebRTC data channels

Сейчас весь обмен сообщениями происходит через WebSocket сервер. Добавление WebRTC data channels позволит участникам обмениваться сообщениями напрямую между собой, минуя сервер. Это снизит нагрузку на сигнальный сервер и уменьшит задержки для обмена служебной информацией, потому что прямое соединение всегда быстрее маршрутизации через промежуточный сервер.

## Failover между серверами

SDK должен поддерживать список резервных серверов и автоматически переключаться при недоступности основного. При обнаружении проблем с текущим сервером клиент попробует подключиться к следующему в списке, сохраняя состояние звонка. Это обеспечит непрерывность работы даже при отказе части инфраструктуры, потому что серверы могут становиться недоступными из-за обновлений или технических проблем.

## Умное переподключение (reconnecting)

При потере соединения SDK должен сохранять контекст звонка и восстанавливать его после переподключения. Система запомнит участников, их роли, состояние медиа-потоков и автоматически восстановит все это при возобновлении связи. Экспоненциальные задержки между попытками предотвратят перегрузку сервера, потому что сетевые проблемы часто временны и требуют разумных интервалов для восстановления.

## Адаптивное качество видео

SDK должен автоматически подстраивать качество передачи под условия сети каждого участника. Мониторинг статистики соединения позволит динамически менять разрешение, битрейт и частоту кадров. При критическом ухудшении связи система автоматически переключится на передачу только звука, потому что стабильная связь важнее высокого качества изображения.

## Очередь событий с приоритетами

В сложных сценариях с множеством участников важно правильно обрабатывать поток событий. Критические события (подключение/отключение участников) должны обрабатываться немедленно, а менее важные (изменение статуса) могут ждать в очереди. Это предотвратит блокировку системы при пиковых нагрузках, потому что не все события одинаково важны для функционирования звонка.
